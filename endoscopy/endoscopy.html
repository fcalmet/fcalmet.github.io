<!DOCTYPE html>
<!--
	 Copyright (C) 2025 by Fernando Calmet

	 Author: Fernando Calmet

	 This program is free software; you can redistribute it and/or modify
	 it under the terms of the GNU General Public License as published by
	 the Free Software Foundation, either version 3 of the License, or
	 (at your option) any later version.

	 This program is distributed in the hope that it will be useful,
	 but WITHOUT ANY WARRANTY; without even the implied warranty of
	 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	 GNU General Public License for more details.

	 You should have received a copy of the GNU General Public License
	 along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->
<html lang="en">
  <head>
	<meta charset="UTF-8">
	<title>Endoscopy Reporting System</title>
	<link rel="stylesheet" href="endoscopy.css" />
  </head>
  <body>
	<h1>Endoscopy Reporting System</h1>
	<div class="app">
	  <div class="col">
		<h2>Procedure</h2>
		<select id="procedure-list" size="5"></select>
		<h2>Report</h2>
		<textarea id="report" cols="50"></textarea>
	  </div>
	  <div class="col">
		<h2>Finding</h2>
		<select id="finding-list" size="40"></select>
	  </div>
	  <div class="col multi" id="finding-options">
	  </div>
	  <div class="col">
		<h2>Interventions</h2>
		<select id="intervention-list" size="40"></select>
	  </div>
	  <div class="col multi" id="intervention-options">
	  </div>
	  <div class="col" id="selected-interventions">
		<h2>Selected</h2>
		<select id="sel-intervention-list" size="40"></select>
	  </div>
	</div>

	<!-- Inline JSON -->
	<script id="jsonData" type="application/json">
	 {
	   "procedures": [
		 { "name": "EGD", "sections": [ "Esophagus", "Stomach", "Duodenum", "Jejunum" ] },
		 { "name": "Colonoscopy", "sections": [ "DRE", "Ileum", "Colon" ] },
		 { "name": "Enteroscopy", "sections": [ "Esophagus", "Stomach", "Duodenum", "Jejunum", "Ileum", "Colon" ] },
		 { "name": "ERCP", "sections": [ "Scout film (ERCP)", "Endoscopic (ERCP)", "Biliary access (ERCP)", "Cholangiogram (ERCP)" ] },
		 { "name": "EUS", "sections": [ "Endoscopic (EUS)", "Luminal (EUS)", "Pancreas (EUS)", "CBD (EUS)", "Gallbladder (EUS)", "Major papilla (EUS)", "Liver (EUS)", "Lymph nodes (EUS)" ] }
	   ],

	   "sections": [
		 { "organ": "Esophagus",
		   "findings": [
			 { "name": "Normal", "text": "Normal esophagus" },
			 { "name": "Achalasia", "text": "Dilated lumen with a tight lower esophageal sphincter, {consistent-suggestive} achalasia" },
			 { "name": "Angiectasia", "text": "{single-few-multiple-angiectasias} {bleeding-type} in the {*esophagus-location}" },
			 { "name": "Barrett esophagus", "text": "Salmon-colored mucosa in the distal esophagus {consistent-suggestive} Barrett esophagus (Prague C{#C} M{#M})" },
			 { "name": "Candida esophagitis", "text": "Candida esophagitis" },
			 { "name": "Clips", "text": "{#Number} previously placed clip(s) in the {*esophagus-location}" },
			 { "name": "Dieulafoy", "text": "A Dieulafoy lesion {bleeding-type} in the {esophagus-location}" },
			 { "name": "Diverticulum", "text": "A {small-large} diverticulum in the {esophagus-location}" },
			 { "name": "Eosinophilic esophagitis", "text": "Esophageal rings and longitudinal furrows {consistent-suggestive} eosinophilic esophagitis" },
			 { "name": "Esophagitis", "text": "LA grade {la-grade} esophagitis" },
			 { "name": "Foreign body", "text": "Foreign body in the {*esophagus-location}" },
			 { "name": "Inlet patch", "text": "A {#Size (mm)} mm inlet patch in the proximal esophagus" },
			 { "name": "Mallory-Weiss tear", "text": "Mallory-Weiss tear in the distal esophagus {bleeding-type}" },
			 { "name": "Mass", "text": "{stricture-type} mass in the {esophagus-location} at {#Location (cm)} cm, {traversable} with an {*gastroscope-type}" },
			 { "name": "Nodule", "text": "A {#Size (mm)} mm nodule in the {esophagus-location}" },
			 { "name": "Polyp", "text": "A {#Size (mm)} mm polyp in the {esophagus-location}" },
			 { "name": "Postoperative anatomy", "text": "Postoperative anatomy consistent with prior {esophageal-surgery}" },
			 { "name": "Schatzki ring", "text": "{sr-obstructing} Schatzki ring at the EGJ" },
			 { "name": "Stricture", "text": "{stricture-type} stricture at {#Location (cm)} cm, {traversable} with an {*gastroscope-type}" },
			 { "name": "Subepithelial lesion", "text": "A {#Size (mm)} mm subepithelial lesion in the {esophagus-location}" },
			 { "name": "Varices", "text": "{small-large} esophageal varices {bleeding-type} {gev-hrs}" }
		   ],
		   "interventions": [
			 { "name": "Banding", "text": "{#Bands placed} band(s) deployed with adequate decompression" },
			 { "name": "Botulinum toxin (LES)", "text": "LES botulinum toxin injection performed" },
			 { "name": "Botulinum toxin (distal esophagus)", "text": "Distal esophageal botulinum toxin injection performed" },
			 { "name": "Epinephrine injection", "text": "Epinephrine injection performed" },
			 { "name": "Biopsies (Seattle protocol)", "text": "Biopsied as per Seattle protocol" },
			 { "name": "Biopsies (proximal/distal)", "text": "Proximal and distal esophageal biopsies taken" },
			 { "name": "Biopsies", "text": "Biopsied" },
			 { "name": "Cautery (APC)", "text": "Treated with APC" },
			 { "name": "Cautery (bipolar)", "text": "Treated with bipolar cautery" },
			 { "name": "Cautery (coagrasper)", "text": "Treated with coagrasper cautery" },
			 { "name": "Clip (over-the-scope)", "text": "Over-the-scope clip deployed" },
			 { "name": "Clips", "text": "{#Clips deployed} clip(s) deployed" },
			 { "name": "Dilation (Savary-Gilliard)", "text": "Savary-Gilliard dilation performed to {#Size (Fr)} Fr" },
			 { "name": "Dilation (TTS balloon)", "text": "TTS balloon dilation performed to {#Size (mm)} mm" },
			 { "name": "EMR (band)", "text": "Removed by band-EMR" },
			 { "name": "EMR (one piece)", "text": "Removed by EMR in one piece" },
			 { "name": "EMR (piecemeal)", "text": "Removed by EMR in piecemeal fashion" },
			 { "name": "Polypectomy (cold forceps)", "text": "Removed with cold biopsy forceps" },
			 { "name": "Polypectomy (cold snare)", "text": "Removed with cold snare" },
			 { "name": "Polypectomy (hot snare)", "text": "Removed with hot snare" },
			 { "name": "RFA 360", "text": "Treated with RFA 360 ({#Ablations} ablations)" },
			 { "name": "RFA 90", "text": "Treated with RFA 90 ({#Ablations} ablations)" },
			 { "name": "RFA TTS", "text": "Treated with TTS RFA ({#Ablations} ablations)" }
		   ]
		 },

		 { "organ": "Stomach",
		   "findings": [
			 { "name": "Normal", "text": "Normal stomach" },
			 { "name": "Angiectasia", "text": "{single-few-multiple-angiectasias} {bleeding-type} {*stomach-location-modifier} {*stomach-location}" },
			 { "name": "Bezoar", "text": "A {small-medium-large} bezoar in the {*stomach-location-modifier} {*stomach-location}" },
			 { "name": "Clips", "text": "{#Number} previously placed clip(s) in the {*stomach-location-modifier} {*stomach-location}" },
			 { "name": "Dieulafoy", "text": "A Dieulafoy lesion {bleeding-type} in the {stomach-location-modifier} {stomach-location}" },
			 { "name": "Diverticulum", "text": "A {small-medium-large} diverticulum in the {stomach-location-modifier} {stomach-location}" },
			 { "name": "Ectopic pancreas", "text": "A {#Size (mm)} mm subepithelial lesion with central umbilication in the gastric antrum, {consistent-suggestive} of an ectopic pancreas" },
			 { "name": "GAVE", "text": "{mild-moderate-severe} gastric antral vascular ectasia" },
			 { "name": "Gastropathy", "text": "{mild-moderate-severe} {gastropathy-type} gastropathy in the {*stomach-location-modifier} {*stomach-location}" },
			 { "name": "Hiatal hernia", "text": "A {#Size (cm)} hiatal hernia {cameron-lesions}" },
			 { "name": "Mass", "text": "{stricture-type} mass in the {stomach-location-modifier} {stomach-location}" },
			 { "name": "Nodule", "text": "A {#Size (mm)} mm nodule in the {stomach-location-modifier} {stomach-location}" },
			 { "name": "Polyp (single)", "text": "A {#Size (mm)} mm polyp in the {stomach-location-modifier} {stomach-location}" },
			 { "name": "Polyps (multiple)", "text": "{few-multiple} {#Size (mm): from}-{#Size (mm): to} mm polyps in the {*stomach-location-modifier} {*stomach-location}" },
			 { "name": "Postoperative anatomy", "text": "Postoperative anatomy consistent with prior {gastric-surgery}" },
			 { "name": "Stenosis", "text": "Stenosis in the {stomach-location-modifier} {stomach-location}, {traversable} with an {gastroscope-type}" },
			 { "name": "Subepithelial lesion", "text": "A {#Size (mm)} mm subepithelial lesion in the {stomach-location-modifier} {stomach-location}" },
			 { "name": "Ulcer", "text": "{#Number} ulcer(s) measuring up to {#Size (mm)} mm with {pud-forrest} in the {*stomach-location-modifier} {*stomach-location}" },
			 { "name": "Varices", "text": "{small-medium-large} gastric varices in the {gv-type} {bleeding-type} {gev-hrs}" }
		   ],
		   "interventions": [
			 { "name": "Biopsies", "text": "Biopsied" },
			 { "name": "Biopsies (random)", "text": "Random biopsies taken" },
			 { "name": "Biopsies (Sydney protocol)", "text": "Biopsied as per Sydney protocol" },
			 { "name": "Botulinum toxin (pyloric)", "text": "Pyloric botulinum toxin injection performed" },
			 { "name": "Cautery (APC)", "text": "Treated with APC" },
			 { "name": "Cautery (bipolar)", "text": "Treated with bipolar cautery" },
			 { "name": "Cautery (coagrasper)", "text": "Treated with coagrasper cautery" },
			 { "name": "Clip (over-the-scope)", "text": "Over-the-scope clip deployed" },
			 { "name": "Clips", "text": "{#Clips deployed} clip(s) deployed" },
			 { "name": "Dilation (TTS balloon)", "text": "TTS balloon dilation performed to {#Size (mm)} mm" },
			 { "name": "EMR (band)", "text": "Removed by band-EMR" },
			 { "name": "EMR (one piece)", "text": "Removed by EMR in one piece" },
			 { "name": "EMR (piecemeal)", "text": "Removed by EMR in piecemeal fashion" },
			 { "name": "Epinephrine injection", "text": "Epinephrine injection performed" },
			 { "name": "Polypectomy (cold forceps)", "text": "Removed with cold biopsy forceps" },
			 { "name": "Polypectomy (cold snare)", "text": "Removed with cold snare" },
			 { "name": "Polypectomy (hot snare)", "text": "Removed with hot snare" }
		   ]
		 },

		 { "organ": "Duodenum",
		   "findings": [
			 { "name": "Normal", "text": "Normal examined duodenum" },
			 { "name": "Angiectasia", "text": "{single-few-multiple-angiectasias} {bleeding-type} {*duodenum-location}" },
			 { "name": "Celiac disease", "text": "Mucosal changes including scalloping in the {*duodenum-location}, {consistent-suggestive} celiac disease" },
			 { "name": "Clips", "text": "{#Number} previously placed clip(s) in the {*duodenum-location}" },
			 { "name": "Dieulafoy", "text": "A Dieulafoy lesion {bleeding-type} {duodenum-location}" },
			 { "name": "Diverticulum", "text": "A {small-medium-large} diverticulum in the {duodenum-location}" },
			 { "name": "Duodenopathy", "text": "{mild-moderate-severe} {duodenopathy-type} gastropathy in the {*duodenum-location}" },
			 { "name": "Mass", "text": "{stricture-type} mass in the {duodenum-location}" },
			 { "name": "Nodule", "text": "A {#Size (mm)} mm nodule in the {duodenum-location}" },
			 { "name": "Polyp", "text": "A {#Size (mm)} mm polyp in the {duodenum-location}" },
			 { "name": "Subepithelial lesion", "text": "A {#Size (mm)} mm subepithelial lesion in the {duodenum-location}" },
			 { "name": "Ulcer", "text": "{#Number} ulcer(s) measuring up to {#Size (mm)} mm with {pud-forrest} in the {*duodenum-location}" }
		   ],
		   "interventions": [
			 { "name": "Biopsies", "text": "Biopsied" },
			 { "name": "Biopsies (random)", "text": "Random biopsies taken" },
			 { "name": "Cautery (APC)", "text": "Treated with APC" },
			 { "name": "Cautery (bipolar)", "text": "Treated with bipolar cautery" },
			 { "name": "Cautery (coagrasper)", "text": "Treated with coagrasper cautery" },
			 { "name": "Clip (over-the-scope)", "text": "Over-the-scope clip deployed" },
			 { "name": "Clips", "text": "{#Clips deployed} clip(s) deployed" },
			 { "name": "Dilation (TTS balloon)", "text": "TTS balloon dilation performed to {#Size (mm)} mm" },
			 { "name": "EMR (band)", "text": "Removed by band-EMR" },
			 { "name": "EMR (one piece)", "text": "Removed by EMR in one piece" },
			 { "name": "EMR (piecemeal)", "text": "Removed by EMR in piecemeal fashion" },
			 { "name": "Epinephrine injection", "text": "Epinephrine injection performed" },
			 { "name": "Polypectomy (cold forceps)", "text": "Removed with cold biopsy forceps" },
			 { "name": "Polypectomy (cold snare)", "text": "Removed with cold snare" },
			 { "name": "Polypectomy (hot snare)", "text": "Removed with hot snare" }
		   ]
		 },

		 { "organ": "DRE",
		   "findings": [
			 { "name": "Normal", "text": "Normal rectal exam" }
		   ],
		   "interventions": []
		 },

		 { "organ": "Ileum",
		   "findings": [
			 { "name": "Normal", "text": "Normal examined terminal ileum" }
		   ],
		   "interventions": [
			 { "name": "Biopsies", "text": "Biopsied" },
			 { "name": "Biopsies (random)", "text": "Random biopsies taken" },
			 { "name": "Cautery (APC)", "text": "Treated with APC" },
			 { "name": "Cautery (bipolar)", "text": "Treated with bipolar cautery" },
			 { "name": "Cautery (coagrasper)", "text": "Treated with coagrasper cautery" },
			 { "name": "Clip (over-the-scope)", "text": "Over-the-scope clip deployed" },
			 { "name": "Clips", "text": "{#Clips deployed} clip(s) deployed" },
			 { "name": "Dilation (TTS balloon)", "text": "TTS balloon dilation performed to {#Size (mm)} mm" },
			 { "name": "EMR (band)", "text": "Removed by band-EMR" },
			 { "name": "EMR (one piece)", "text": "Removed by EMR in one piece" },
			 { "name": "EMR (piecemeal)", "text": "Removed by EMR in piecemeal fashion" },
			 { "name": "Epinephrine injection", "text": "Epinephrine injection performed" },
			 { "name": "Polypectomy (cold forceps)", "text": "Removed with cold biopsy forceps" },
			 { "name": "Polypectomy (cold snare)", "text": "Removed with cold snare" },
			 { "name": "Polypectomy (hot snare)", "text": "Removed with hot snare" }
		   ]
		 },

		 { "organ": "Colon",
		   "findings": [
			 { "name": "Right colon retroflexion", "text": "Retroflexion performed in the right colon" },
			 { "name": "Normal", "text": "Normal colon" },
			 { "name": "Angiectasia", "text": "{single-few-multiple-angiectasias} {bleeding-type} {*colon-location}" },
			 { "name": "Dieulafoy", "text": "A Dieulafoy lesion {bleeding-type} {colon-location}" },
			 { "name": "Diverticulosis", "text": "{mild-moderate-severe} diverticulosis in the {*colon-location}" },
			 { "name": "Internal hemorrhoids", "text": "{small-medium-large} internal hemorrhoids" },
			 { "name": "Mass", "text": "{stricture-type} mass in the {colon-location}" },
			 { "name": "Polyp (single)", "text": "A {#Size (mm)} mm {polyp-morphology} polyp in the {colon-location}" },
			 { "name": "Polyp (multiple)", "text": "{#Number} {#Min size (mm)}-{#Max size (mm)} mm {polyps-morphology} polyps in the {*colon-location}" },
			 { "name": "Solitary rectal ulcer syndromoe", "text": "A {#Size (mm)} ulcer in the distal rectum, consistent with solitary rectal ulcer syndrome" },
			 { "name": "Ulcerative colitis", "text": "Continuous inflammation from the rectum to the {colon-location} {consistent-suggestive} {uc-extent} ({uc-mayo})" },
			 { "name": "Ulcerative proctitis", "text": "Inflammation in the rectum {consistent-suggestive} ulcerative proctitis ({uc-mayo}) " }
		   ],
		   "interventions": [
			 { "name": "Biopsies (random)", "text": "Random biopsies taken" },
			 { "name": "Biopsies", "text": "Biopsied" },
			 { "name": "Cautery (APC)", "text": "Treated with APC" },
			 { "name": "Cautery (bipolar)", "text": "Treated with bipolar cautery" },
			 { "name": "Cautery (coagrasper)", "text": "Treated with coagrasper cautery" },
			 { "name": "Clip (over-the-scope)", "text": "Over-the-scope clip deployed" },
			 { "name": "Clips", "text": "{#Clips deployed} clip(s) deployed" },
			 { "name": "Dilation (TTS balloon)", "text": "TTS balloon dilation performed to {#Size (mm)} mm" },
			 { "name": "EMR (band)", "text": "Removed by band-EMR" },
			 { "name": "EMR (one piece)", "text": "Removed by EMR in one piece" },
			 { "name": "EMR (piecemeal)", "text": "Removed by EMR in piecemeal fashion" },
			 { "name": "Epinephrine injection", "text": "Epinephrine injection performed" },
			 { "name": "Hot avulsion", "text": "Treated with hot avulsion" },
			 { "name": "Polypectomy (cold forceps)", "text": "Removed with cold biopsy forceps" },
			 { "name": "Polypectomy (cold snare)", "text": "Removed with cold snare" },
			 { "name": "Polypectomy (hot snare)", "text": "Removed with hot snare" },
			 { "name": "Snare tip cautery", "text": "Snare tip cautery performed" },
			 { "name": "Tattoo", "text": "Tattooed" }
		   ]
		 },

		 { "organ": "Scout film (ERCP)",
		   "findings": [
			 { "name": "Normal", "text": "Normal scout film" },
			 { "name": "Cholecystectomy clips", "text": "Clips from prior cholecystectomy noted on scout film" },
			 { "name": "Stents (metal)", "text": "{#Number} metal stent(s) noted in the {biliary-stent-location}" },
			 { "name": "Stents (plastic)", "text": "{#Number} plastic stent(s) noted in the {biliary-stent-location}" },
			 { "name": "Stents (metal and plastic)", "text": "{#Metal stents} metal stent(s) noted in the {biliary-stent-location} and {#Plastic stents} plastic stent(s) noted in the {biliary-stent-location}" }
		   ],
		   "interventions": []
		 },

		 { "organ": "Endoscopic (ERCP)",
		   "findings": [
			 { "name": "Normal", "text": "Normal esophagus, stomach, and examined duodenum on examination with the duodenoscope" },
			 { "name": "Normal major papilla", "text": "Normal major papilla" },
			 { "name": "Periampullary diverticulum", "text": "Major papilla located {periampullary-location} a {small-medium-large} duodenal diverticulum" },
			 { "name": "Prior sphincterotomy", "text": "Major papilla with evidence of prior sphincterotomy" },
			 { "name": "Prior CBD stents in place", "text": "{#Number} {plastic-metal} stent(s) seen emerging from the biliary orifice. {stent-removal}" },
			 { "name": "Prior PD stent in place", "text": "Plastic stent seen emerging from the pancreatic orifice. {stent-removal}" }
		   ],
		   "interventions": [
			 { "name": "Stent removal", "text": "Removed with a {snare-forceps}" }
		   ]
		 },

		 { "organ": "Biliary access (ERCP)",
		   "findings": [
			 { "name": "CBD cannulation", "text": "CBD cannulation performed with {sphincterotome-balloon}" },
			 { "name": "CBD cannulation (difficult)", "text": "Difficult CBD cannulation performed with a sphincterotome using {*difficult-cannulation-technique}" },
			 { "name": "PD cannulation", "text": "PD cannulation performed with {sphincterotome-balloon}" },
			 { "name": "Biliary sphincterotomy", "text": "Biliary sphincterotomy performed" },
			 { "name": "Biliary sphincteroplasty", "text": "Biliary sphincteroplasty performed to {#Size (mm)} mm" },
			 { "name": "Pancreatic sphincterotomy", "text": "Pancreatic sphincterotomy performed" },
			 { "name": "Pancreatic sphincteroplasty", "text": "Pancreatic sphincteroplasty performed to {#Size (mm)} mm" }
		   ],
		   "interventions": [
			 { "name": "Clip(s)", "text": "{#Number} clip(s) deployed for hemostasis" },
			 { "name": "Epinephrine", "text": "Epinephrine injected for hemostasis" },
			 { "name": "Epinephrine + Clip(s)", "text": "Epinephrine injected and {#Number} clip(s) deployed for hemostasis" }
		   ]
		 },

		 { "organ": "Cholangiogram (ERCP)",
		   "findings": [
			 { "name": "Normal", "text": "Normal cholangiogram with CBD measuring {#CBD size (mm)} mm" },
			 { "name": "CBD dilation", "text": "Cholangiogram significant for CBD dilation to {#CBD size (mm)} mm" },
			 { "name": "CBD dilation + Filling defects", "text": "Cholangiogram significant for CBD dilation to {#CBD size (mm)} mm with {filling-defects}" },
			 { "name": "Filling defects", "text": "Cholangiogram significant for a CBD measuring {#CBD size (mm)} mm with {filling-defects}" },
			 { "name": "Stricture", "text": "Cholangiogram significant for a {#Length (mm)} mm long, {mild-moderate-severe}, {stricture-type} stricture in the {biliary-stricture-location} with upstream dilation to {#Upstream dilation to (mm)} mm" }
		   ],
		   "interventions": [
			 { "name": "Balloon sweeps", "text": "Balloon sweeps performed with a {extraction-balloon-size} balloon with removal of {*stones-sludge-pus}" },
			 { "name": "Basket sweeps", "text": "{#Stones removed} stone(s) removed with a basket" },
			 { "name": "Stents (plastic)", "text": "{#Number} {#Width (Fr)} Fr × {#Length (cm)} cm {plastic-stent-type} plastic stents placed {stent-placement}" },
			 { "name": "Stents (metal)", "text": "{#Number} {#Width (mm)} × {#Length (mm)} mm {metal-stent-type} self-expanding metal stent placed {stent-placement}" },
			 { "name": "Stricture brushings", "text": "Stricture brushings performed for cytology" },
			 { "name": "Stricture dilation", "text": "Stricture dilation performed to {#Size (mm)} mm" }
		   ]
		 },

		 { "organ": "Endoscopic (EUS)",
		   "findings": [
			 { "name": "Normal", "text": "Normal esophagus, stomach, and examined duodenum on examination with the echoendoscope" }
		   ],
		   "interventions": []
		 },

		 { "organ": "Luminal (EUS)",
		   "findings": [
			 { "name": "SEL (esophagus)", "text": "A {#Size 1 (mm)} x {#Size 2 (mm)} mm {echogenicity} subepithelial lesion in the {esophagus-location}, arising from {eus-layer}" },
			 { "name": "SEL (stomach)", "text": "A {#Size 1 (mm)} x {#Size 2 (mm)} mm {echogenicity} subepithelial lesion in the {stomach-location-modifier} {stomach-location}, arising from {eus-layer}" },
			 { "name": "SEL (duodenum)", "text": "A {#Size 1 (mm)} x {#Size 2 (mm)} mm {echogenicity} subepithelial lesion in the {duodenum-location}, arising from {eus-layer}" },
			 { "name": "SEL (colon)", "text": "A {#Size 1 (mm)} x {#Size 2 (mm)} mm {echogenicity} subepithelial lesion in the {colon-location}, arising from {eus-layer}" }
		   ],
		   "interventions": [
			 { "name": "FNA", "text": "FNA performed ({#Passes} passes) {fnab-preliminary}" },
			 { "name": "FNB", "text": "FNB performed ({#Passes} passes)" }
		   ]
		 },

		 { "organ": "Pancreas (EUS)",
		   "findings": [
			 { "name": "Normal", "text": "Normal pancreatic parenchyma and duct" },
			 { "name": "Chronic pancreatitis", "text": "Pancreatic parenchymal changes include {*cp-parenchyma}. Pancreatic ductal changes include {*cp-duct}. Findings {cp-consistent} chronic pancreatitis" },
			 { "name": "Cyst (single)", "text": "A cyst measuring at least {#Size 1 (mm)} x {#Size 2 (mm)} mm in the {*pancreas-location} {pancreatic-cyst-risk-features}" },
			 { "name": "Cysts (multiple)", "text": "{few-multiple} cysts measuring up to {#Size 1 (mm)} x {#Size 2 (mm)} mm in the {*pancreas-location} {pancreatic-cyst-risk-features}" },
			 { "name": "PD dilation", "text": "PD dilation up to {#Size (mm)} mm" },
			 { "name": "Mass", "text": "A {echogenicity} mass measuring at least {#Size 1 (mm)} x {#Size 2 (mm)} mm in the {*pancreas-location}" }
		   ],
		   "interventions": [
			 { "name": "Fiducials", "text": "{#Number} fiducial(s) placed" },
			 { "name": "FNA", "text": "FNA performed ({#Passes} passes) {fnab-preliminary}" },
			 { "name": "FNB", "text": "FNB performed ({#Passes} passes)" }
		   ]
		 },

		 { "organ": "CBD (EUS)",
		   "findings": [
			 { "name": "Normal", "text": "Normal CBD measuring {#Size (mm)} mm {stones-sludge}" },
			 { "name": "CBD dilation", "text": "CBD dilation to {#Size (mm)} mm {stones-sludge}" },
			 { "name": "Stone (single)", "text": "A {#Size (mm)} mm CBD stone {shadowing}" },
			 { "name": "Stones (multiple)", "text": "{few-multiple} CBD stones measuring up to {#Size (mm)} mm {shadowing}" }
		   ],
		   "interventions": []
		 },

		 { "organ": "Gallbladder (EUS)",
		   "findings": [
			 { "name": "Normal", "text": "Normal gallbladder" },
			 { "name": "Dilated", "text": "Dilated gallbladder" },
			 { "name": "Polyp (single)", "text": "A {#Size (mm)} mm gallbladder polyp" },
			 { "name": "Polyps (multiple)", "text": "{few-multiple} gallbladder polyps measuring up to {#Size (mm)} mm" },
			 { "name": "Sludge", "text": "Sludge noted within the gallbladder" },
			 { "name": "Stone (single)", "text": "A {#Size (mm)} mm gallbladder stone {shadowing}" },
			 { "name": "Stones (multiple)", "text": "{few-multiple} gallbladder stones measuring up to {#Size (mm)} mm {shadowing}" },
			 { "name": "Wall thickening", "text": "Gallbladder wall thickening to {#Size (mm)} mm" }
		   ],
		   "interventions": []
		 },

		 { "organ": "Major papilla (EUS)",
		   "findings": [
			 { "name": "Normal", "text": "Normal major papilla on {mp-visualization} visualization" },
			 { "name": "Periampullary diverticulum", "text": "Major papilla located {periampullary-location} a {small-medium-large} duodenal diverticulum" },
			 { "name": "Prior sphincterotomy", "text": "Major papilla with evidence of prior sphincterotomy" }
		   ],
		   "interventions": []
		 },

		 { "organ": "Liver (EUS)",
		   "findings": [
			 { "name": "Normal (visualized)", "text": "Normal visualized portion of the liver" },
			 { "name": "Cyst (single)", "text": "A hepatic cyst measuring at least {#Size 1 (mm)} x {#Size 2 (mm)} mm" },
			 { "name": "Cysts (multiple)", "text": "{few-multiple} hepatic cysts measuring up to {#Size 1 (mm)} x {#Size 2 (mm)} mm" },
			 { "name": "Mass", "text": "A {echogenicity} mass measuring at least {#Size 1 (mm)} x {#Size 2 (mm)} mm in the liver" },
			 { "name": "Steatosis", "text": "Hyperechoic hepatic parenchyma suggestive of steatosis" }
		   ],
		   "interventions": [
			 { "name": "FNA", "text": "FNA performed ({#Passes} passes) {fnab-preliminary}" },
			 { "name": "FNB", "text": "FNB performed ({#Passes} passes)" }
		   ]
		 },

		 { "organ": "Lymph nodes (EUS)",
		   "findings": [
			 { "name": "No lymphadenopathy", "text": "No lymphadenopathy identified" }
		   ],
		   "interventions": [
			 { "name": "FNA", "text": "FNA performed ({#Passes} passes) {fnab-preliminary}" },
			 { "name": "FNB", "text": "FNB performed ({#Passes} passes)" }
		   ]
		 }
	   ],

	   "selection": [
		 { "name": "biliary-stent-location", "label": "Location", "options": [ "CBD", "left hepatic duct", "right hepatic duct", "left and right hepatic duct" ] },
		 { "name": "biliary-stricture-location", "label": "Location", "options": [ "distal CBD", "mid CBD", "proximal CBD", "CHD", "left hepatic duct", "right hepatic duct", "left and right hepatic duct" ] },
		 { "name": "bleeding-type", "label": "Bleeding", "options": [ [ "no bleeding", "without bleeding" ], [ "oozing", "with oozing of blood" ], [ "spurting", "with spurting of blood" ] ] },
		 { "name": "cameron-lesions", "label": "Cameron lesions", "options": [ [ "", "" ], [ "none", " without Cameron lesions" ], [ "non-bleeding", " with non-bleeding Cameron lesions" ], [ "oozing", " with Cameron lesions with oozing" ], [ "spurting", " with Cameron lesions with spurting" ] ] },
		 { "name": "colon-location", "label": "Location", "options": [ "entire colon", "cecum", "ascending colon", "hepatic flexure", "transverse colon", "splenic flexure", "descending colon", "sigmoid colon", "rectum", "ileocolic anastomosis", "colocolic anastomosis", "ileorectal anastomosis" ] },
		 { "name": "consistent-suggestive", "label": "Diagnostic certainty", "options": [ [ "consistent", "consistent with" ], [ "suggestive", "suggestive of" ] ] },
		 { "name": "cp-consistent", "label": "Diagnostic certainty", "options": [ [ "consistent (≥4 criteria)", "consistent with" ], [ "not consistent (<4 criteria)", "not consistent with" ] ] },
		 { "name": "cp-duct", "label": "Ductal changes", "options": [ "dilation", "irregular margins", "hyperechoic margins", "visible side branches" ] },
		 { "name": "cp-parenchyma", "label": "Parenchymal changes", "options": [ "hyperechoic foci", "hyperechoic strands", "lobularity", "shadowing calcifications", "cysts" ] },
		 { "name": "difficult-cannulation-technique", "label": "Cannulation techniques", "options": [ [ "double-wire technique", "a double-wire technique" ], [ "PD placement", "PD placement" ], [ "precut sphincterotomy", "precut sphincterotomy" ] ] },
		 { "name": "duodenopathy-type", "label": "Duodenopathy type", "options": [ "", "erythematous", "erosive" ] },
		 { "name": "duodenum-location", "label": "Location", "options": [ [ "entire examined duodenum", "entire examined duodenum" ], [ "D1", "duodenal bulb" ], [ "D2", "second portion of the duodenum" ], [ "D3", "third portion of the duodenum" ], [ "D4", "fourth portion of the duodenum" ], [ "periampullary region", "periampullary region" ] ] },
		 { "name": "echogenicity", "label": "Echogenicity", "options": [ "hypoechoic", "isoechoic", "hyperechoic", "heterogeneous" ] },
		 { "name": "esophageal-surgery", "label": "Surgery", "options": [ "esophagectomy with gastric pull-up", "esophagectomy with colonic interposition" ] },
		 { "name": "esophagus-location", "label": "Location", "options": [ "entire esophagus", "proximal esophagus", "mid esophagus", "distal esophagus" ] },
		 { "name": "eus-layer", "label": "EUS layer", "options": [ "layer 1 (superficial mucosa)", "layer 2 (deep mucosa)", "layer 3 (submucosa)", "layer 4 (muscularis propria)", "layer 5 (serosa)" ] },
		 { "name": "extraction-balloon-size", "label": "Extraction Balloon", "options": [ "9-12 mm", "12-15 mm", "15-18 mm" ] },
		 { "name": "few-multiple", "label": "Few/multiple", "options": [ [ "few", "a few" ], [ "multiple", "multiple" ] ] },
		 { "name": "filling-defects", "label": "Filling defects", "options": [ [ "single", "a filling defect suggestive of a stone" ], [ "few", "a few filling defects suggestive of stones" ], [ "multiple", "multiple filling defects suggestive of stones" ], [ "sluldge", "filling defects suggestive of sludge" ] ] },
		 { "name": "fnab-preliminary", "label": "Preliminary cytology", "options": [ [ "", "" ], [ "benign", "with preliminary cytology negative for malignancy" ], [ "indeterminate", "with preliminary cytology indeterminate for malignancy" ], [ "malignant", "with preliminary cytology suggestive of malignancy" ]   ] },
		 { "name": "gastric-surgery", "label": "Surgery", "options": [ "Rouy-en-Y gastric bypass", "sleeve gastrectomy", "Billroth I anastomosis", "Billroth II anastomosis" ] },
		 { "name": "gastropathy-type", "label": "Gastropathy type", "options": [ "", "erythematous", "erosive", "portal hypertensive" ] },
		 { "name": "gastroscope-type", "label": "Gastroscope type", "options": [ "adult gastroscope", "ultraslim gastroscope" ] },
		 { "name": "gev-hrs", "label": "High risk stigmata", "options": [ [ "", "" ], [ "no", "without high risk stigmata" ], [ "yes", "with high risk stigmata" ] ] },
		 { "name": "gv-type", "label": "GV Type", "options": [ [ "GOV1 (lesser curvature)", "lesser curvature in continuity with esophageal varices (GOV1)" ], [ "GOV2 (fundal)", "gastric fundus in continuity with esophageal varices (GOV2)" ], [ "IGV1 (fundus)", "gastric fundus (IGV1)" ], [ "IGV2 (body)", "gastric body (IGV2)" ], [ "IGV2 (antrum)", "gastric antrum (IGV2)" ] ] },
		 { "name": "la-grade", "label": "LA grade", "options": [ "A", "B", "C", "D" ] },
		 { "name": "metal-stent-type", "label": "Stent type", "options": [ "uncovered", "partially covered", "fully covered" ] },
		 { "name": "mild-moderate-severe", "label": "Severity", "options": [ "mild", "moderate", "severe" ] },
		 { "name": "mp-visualization", "label": "Visualization", "options": [ "endoscopic and endosonographic", "endosonographic", "endoscopic" ] },
		 { "name": "pancreas-location", "label": "Location", "options": [ "pancreatic uncinate process", "pancreatic head", "pancreatic neck", "pancreatic body", "pancreatic tail" ] },
		 { "name": "pancreatic-cyst-risk-features", "label": "High-risk features", "options": [ [ "none", "without high risk features" ], [ "thin septae", "with thin septae" ], [ "thick septae", "with this septae" ], [ "mural nodule", "with a mural nodule" ] ] },
		 { "name": "periampullary-location", "label": "Location", "options": [ [ "entirely within", "entirely within" ], [ "partially within", "partially within a" ], [ "on the rim", "on the rim of" ], [ "adjacent", "adjacent to" ] ] },
		 { "name": "plastic-metal", "label": "Stent type", "options": [ "plastic", "metal" ] },
		 { "name": "plastic-stent-type", "label": "Stent type", "options": [ "straight", "double pigtail", "single pigtail" ] },
		 { "name": "polyp-morphology", "label": "Morphology", "options": [ "sessile", "flat", "pedunculated", "carpetted" ] },
		 { "name": "polyps-morphology", "label": "Morphology", "options": [ "sessile", "flat", "pedunculated", "carpetted", "sessile/flat", "sessile/pedunculated", "flat/pedunculated" ] },
		 { "name": "pud-forrest", "label": "Forrest classification", "options": [ "pulsatile bleeding (Forrest Ia)", "oozing of blood (Forrest Ib)", "a visible vessel (Forrest IIa)", "an adherent clot (Forrest IIb)", "a pigmented spot (Forrest IIc)", "a clean-base (Forrest III)" ] },
		 { "name": "shadowing", "label": "Shadowing", "options": [ [ "no", "without shadowing" ], [ "yes", "with shadowing" ] ] },
		 { "name": "single-few-multiple-angiectasias", "label": "Number", "options": [ ["single", "a single angiectasia"], ["few", "a few angiectasias"], ["multiple", "multiple angiectasias"] ] },
		 { "name": "small-large", "label": "Size", "options": [ "small", "large" ] },
		 { "name": "small-medium-large", "label": "Size", "options": [ "small", "medium", "large" ] },
		 { "name": "snare-forceps", "label": "Snare/forceps", "options": [ "snare", "forceps" ] },
		 { "name": "sphincterotome-balloon", "label": "Cannulated with", "options": [ [ "sphincterotome", "a sphincterotome" ], [ "balloon", "an extraction balloon" ] ] },
		 { "name": "sr-obstructing", "label": "Obstructing?", "options": [ "Widely patent, non-obstructing", "Partially obstructing", "Obstructing" ] },
		 { "name": "stent-placement", "label": "Location", "options": [ [ "stricture", "across the stricture" ], [ "CBD", "in the CBD" ], [ "left hepatic duct", "in the left hepatic duct" ], [ "right hepatic duct", "in the right hepatic duct" ], [ "left/right hepatic ducts", "in the left and right hepatic ducts" ] ] },
		 { "name": "stomach-location", "label": "Location", "options": [ "gastric fundus", "gastric body", "gastric antrum", "cardia", "incisura", "pylorus", "gastrojejunal anastomosis" ] },
		 { "name": "stomach-location-modifier", "label": "Location", "options": [ [ "", "" ], [ "greater curvature", "greater curvature of the" ], [ "lesser curvature", "lesser curvature of the" ], [ "anterior wall", "anterior wall of the" ], [ "posterior wall", "posterior wall of the" ] ] },
		 { "name": "stones-sludge", "label": "Stones/sludge", "options": [ [ "none", "without stones/sludge" ], [ "sludge", "with sludge" ], [ "stone (one)", "with a stone" ], [ "stones (few)", "with a few stones" ], [ "sludge/stones", "with sludge and stones" ] ] },
		 { "name": "stones-sludge-pus", "label": "Stones/sludge/pus", "options": [ [ "stone (single)", "a stone" ], [ "stones (few)", "a few stones" ], [ "stones (multiple)", "multiple stones" ],[ "stones (fragments)", "stone fragments" ], [ "sludge", "sludge" ], [ "pus", "pus" ] ] },
		 { "name": "stricture-type", "label": "Appearance", "options": [ "benign-appearing", "malignant-appearing", "indeterminate" ] },
		 { "name": "traversable", "label": "Traversable", "options": [ "traversable", "not traversable" ] },
		 { "name": "uc-extent", "label": "UC extent", "options": [ "left-sided UC", "pancolonic UC" ] },
		 { "name": "uc-mayo", "label": "Severity", "options": [ "Mayo 0", "Mayo 1", "Mayo 2", "Mayo 3" ] }
	   ],

	   "replace": [
		 [ "proximal esophagus and mid esophagus", "proximal and mid esophagus" ],
		 [ "proximal esophagus, mid esophagus, and distal esophagus", "entire esophagus" ],
		 [ "mid esophagus and distal esophagus", "mid and distal esophagus" ],
		 [ "proximal esophagus and distal esophagus", "proximal and distal esophagus" ],
		 [ "gastric fundus and gastric body", "gastric fundus and body" ],
		 [ "gastric fundus and gastric antrum", "gastric fundus and antrum" ],
		 [ "gastric body and gastric antrum", "gastric body and antrum" ],
		 [ "gastric fundus, gastric body, and gastric antrum", "gastric fundus, body, and antrum" ],
		 [ "gastric fundus, gastric body, and cardia", "gastric fundus, body, and cardia" ],
		 [ "gastric fundus, gastric body, and incisura", "gastric fundus, body, and incisura" ],
		 [ "gastric fundus, gastric antrum, and cardia", "gastric fundus, antrum, and cardia" ],
		 [ "gastric fundus, gastric antrum, and incisura", "gastric fundus, antrum, and incisura" ],
		 [ "gastric body, gastric antrum, and cardia", "gastric body, antrum, and cardia" ],
		 [ "gastric body, gastric antrum, and incisura", "gastric body, antrum, and incisura" ],
		 [ "gastric fundus, gastric body, gastric antrum, and cardia", "gastric fundus, body, antrum, and cardia" ],
		 [ "gastric fundus, gastric body, gastric antrum, and incisura", "gastric fundus, body, antrum, and incisura" ],
		 [ "gastric fundus, gastric body, cardia, and incisura", "gastric fundus, body, cardia, and incisura" ],
		 [ "gastric fundus, gastric antrum, cardia, and incisura", "gastric fundus, antrum, cardia, and incisura" ],
		 [ "gastric body, gastric antrum, cardia, and incisura", "gastric body, antrum, cardia, and incisura" ],
		 [ "gastric fundus, gastric body, gastric antrum, cardia, and incisura", "gastric fundus, body, antrum, cardia, and incisura" ],
		 [ "duodenal bulb and second portion of the duodenum", "first and second portion of the duodenum" ],
		 [ "duodenal bulb and third portion of the duodenum", "first and third portion of the duodenum" ],
		 [ "duodenal bulb and fourth portion of the duodenum", "first and fourth portion of the duodenum" ],
		 [ "second portion of the duodenum and third portion of the duodenum", "second and third portion of the duodenum" ],
		 [ "second portion of the duodenum and fourth portion of the duodenum", "second and fourth portion of the duodenum" ],
		 [ "third portion of the duodenum and fourth portion of the duodenum", "third and fourth portion of the duodenum" ],
		 [ "duodenal bulb, second portion of the duodenum, and third portion of the duodenum", "first, second, and third portion of the duodenum" ],
		 [ "duodenal bulb, second portion of the duodenum, and fourth portion of the duodenum", "first, second, and fourth portion of the duodenum" ],
		 [ "duodenal bulb, third portion of the duodenum, and fourth portion of the duodenum", "first, third, and fourth portion of the duodenum" ],
		 [ "second portion of the duodenum, third portion of the duodenum, and fourth portion of the duodenum", "second, third, and fourth portion of the duodenum" ],
		 [ "duodenal bulb, second portion of the duodenum, third portion of the duodenum, and fourth portion of the duodenum", "entire duodenum" ]
	   ]
	 }

	</script>
	<script src="endoscopy.js" type="text/javascript"></script>
	<script>
     const db = JSON.parse($('jsonData').textContent);

	 populateProcedureList();

     $('procedure-list')
	   .addEventListener('change', selectProcedure);

	 $('finding-list')
	   .addEventListener('change', selectFinding);

	 $('finding-list')
	   .addEventListener('dblclick', addFinding); // cross event

	 $('finding-list')
		 .addEventListener('keydown', (event) => {
		   if (event.key === 'Enter') {
			 event.preventDefault();
			 addFinding();
		   }
		 });

	 $('intervention-list')
	   .addEventListener('change', selectIntervention);

	 $('intervention-list')
	   .addEventListener('dblclick', addIntervention);

	 $('intervention-list')
	   .addEventListener('keydown', (event) => {
		 if (event.ctrlKey && event.key === 'Enter') {
		   event.preventDefault();
		   addFinding();
		 } else if (event.key === 'Enter') {
		   event.preventDefault();
		   addIntervention();
		 }
	   });

	 $('sel-intervention-list')
	   .addEventListener('keydown', (event) => {
		 if (event.ctrlKey && event.key === 'ArrowUp') {
		   event.preventDefault();
		   moveSelectedInterventionUp();
		 } else if (event.ctrlKey && event.key === 'ArrowDown') {
		   event.preventDefault();
		   moveSelectedInterventionDown(event);
		 } else if (event.ctrlKey && event.key === 'Enter') {
		   event.preventDefault();
		   addFinding();
		 } else if (event.key === 'Delete') {
		   event.preventDefault();
		   deleteSelectedIntervention(event);
		 }
	   });

	 $('procedure-list').selectedIndex = 0;
	 $('procedure-list').dispatchEvent(new Event('change'));
	 $('finding-list').selectedIndex = 1;
	 $('finding-list').dispatchEvent(new Event('change'));
	</script>
  </body>
</html>
